<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>金山之巅--直播室</title>
    <link rel="stylesheet" href="__PUBLIC__/Azureadmin/Content/css/bootstrap.min.css" />
    <link rel="stylesheet" href="__PUBLIC__/Azureadmin/Content/css/bootstrap-responsive.min.css" />
    <link rel="stylesheet" href="__PUBLIC__/Azureadmin/Content/css/unicorn.main.css" />
    <link rel="stylesheet" href="__PUBLIC__/Azureadmin/Content/css/unicorn.jcs.css" class="skin-color" />
    <link href="__PUBLIC__/Azureadmin/Scripts/Lib/artDialog/skins/twitter.css" rel="stylesheet"/>
    <link href="__PUBLIC__/Azureadmin/Content/css/global.css" rel="stylesheet"/>
    <link href="__PUBLIC__/Azureadmin/Content/TeacherRoom/room.css" rel="stylesheet" />
    <link rel="stylesheet" href="__PUBLIC__/Azureadmin/Content/css/datepicker.css" />

</head>
<body>
    <link href="__PUBLIC__/Azureadmin/Content/Home/_partialhead.css" rel="stylesheet" />
    <link href="__PUBLIC__/Azureadmin/Content/ComMessage/commessage.css" rel="stylesheet" />
    <script src="__PUBLIC__/Azureadmin/Scripts/Lib/jquery.js" type="text/javascript"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/Home/_partialhead.js" type="text/javascript"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/ComMessage/ComMessage-common.js"></script>

<div id="header">
    <h1><span>机构服务平台</span></h1>
</div>

<include file="Public:welcome" />

<div id="user-nav" class="navbar navbar-inverse">
    <ul class="nav">
        
        
        <li><a href="/Home/HelpPage" target="_blank"><span class="text">帮助</span></a></li>
    </ul>
</div>

    <if condition="$ComId eq 0">
     <include file="Public:navigate" />
     <else />
    <include file="Public:navigate_other" />
     </if>
    
    <div id="content">
        <div id="breadcrumb"><a href="/Home/Index"><i class="icon-home"></i>欢迎</a><a href="javascript:;">直播室管理</a><a href="/TeacherRoom/LiveRoom" class="current">直播平台</a></div>
        
        <div class="container-fluid">
            

<div class="container-fluid">
        <div class="widget-box">
            <div class="topic">
                <span class="topic_tit">直播主题：</span><strong class="topic_txt" id="con_Title">敬请期待......</strong>
                <button class="btn btn-info" id="btn_EditTitle" data-type="0">编辑</button><input type="text" class="topic_inp" id="txt_EditTitle" maxlength="50" />
                <button class="btn btn-info undis" id="btn_SubmitTit" data-type="0">提交</button>
            </div>
            <div class="send">
                <div class="send_live">
                    <h2>发布直播内容</h2>
                    <div id="live_editor" style="margin: 10px 20px 0 20px; height: 100px;">
                    </div>
                    <div class="send_live_btnbox">
                        <button class="btn" id="btn_SendLive"><i class="icon-plus"></i>发布直播</button>
                        <button class="btn btn-primary" id="btn_SendVipLive"><i class="icon-share-alt icon-white"></i>发布操作建议</button>
                    </div>
                </div>
                <div class="send_inter">
                    <h2>与网友互动</h2>
                    <div id="inter_editor" style="margin: 10px 20px 0 20px; height: 100px;">
                    </div>
                    <div class="send_inter_btnbox">
                        <button class="btn" id="btn_SendInter"><i class="icon-pencil"></i>&nbsp;提交</button>
                    </div>
                </div>
            </div>
            <div class="cl"></div>
            <div class="live">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#inter_list" role="tab" data-toggle="tab">用户发言</a></li>
                    <li><a href="#live_history" role="tab" data-toggle="tab">直播历史</a></li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane active" id="inter_list">
                        <div class="inter_menu">
                            <strong class="fl">操作菜单:</strong><a href="javascript:;" class="fl" id="btn_SelAllInter"><input type="checkbox" class="fl" id="ckb_SelAllInter" />&nbsp;全选/取消</a><a href="javascript:;" id="btn_BatchAudit">批量审核</a><a href="javascript:;" id="btn_BatchDel">批量删除</a>
                            <div class="cl"></div>
                        </div>
                        <div>
                            <ul class="top">
                                <li>
                                    <a class="top50 top_no" id="btn_GetInterTop">已无更多数据</a>
                                </li>
                            </ul>
                        </div>
                        <div class="inter_con">
                            <ul id="InterList">
                            </ul>
                        </div>
                    </div>

                    <div class="tab-pane" id="live_history">
                        <div class="live_his_menu">
                            <div class="time_box">
                                当前记录日期：<input type="text" class="time" value="2016-07-15" id="hisTime" data-olddate="2016-07-15" readonly="readonly"/>
                                <span class="text">直播分类：</span>
                                <select id="selLiveType">
                                    <option value="0">全部</option>
                                    <option value="1">直播</option>
                                    <option value="2">操作建议</option>
                                </select>
                                <span class="text">直播分析师：</span>
                                <select id="selLiveTea">
                                    <option value="全部">全部</option>
                                        <option value="定制老师">定制老师</option>
                                        <option value="程春松">程春松</option>
                                </select>
                            </div>
                        </div>
                        <div class="live_his_top" id="liveTop_Container">
                            <ul id="LiveTopList">
                            </ul>
                        </div>
                        <div class="cl"></div>
                        <div class="live_his_top_btn">
                            <ul class="top">
                                <li>
                                    <a class="top50 top_no" id="btn_GetLiveTop">已无更多数据</a>
                                </li>
                            </ul>
                        </div>
                        <div class="live_his_list" id="liveHis_Container">
                            <ul id="LiveList">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</div>


            
        </div>
    </div>
    <script src="__PUBLIC__/Azureadmin/Scripts/Lib/jquery.js"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/Lib/bootstrap.js"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/Lib/menu.js"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/Lib/require.js"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/config.js"></script>
    <script src="__PUBLIC__/Azureadmin/Scripts/common.js"></script>

    <script type="text/javascript">
        $('#breadcrumb a:last-child').css('background-image', 'none');
        $(window).resize(function () {
            var height = $('#sidebar>ul').height() + 100;
            if (height < 600) {
                height = 600;
            }
            $('#content').css('min-height', height + 'px');
        }).resize();
    </script>
    
        <script src="__PUBLIC__/Azureadmin/Scripts/Lib/ueditor/ueditor.config.js" type="text/javascript"></script>
        <script type="text/javascript" src="__PUBLIC__/Azureadmin/Scripts/Lib/bootstrap-datepicker.js"></script>
        <script type="text/javascript" src="__PUBLIC__/Azureadmin/Scripts/Lib/bootstrap-datepicker.zh-CN.js"></script>
        <script type="text/javascript">
            var uploadImgParams = 'teacherroom,2100';
            var roomInfo = $.parseJSON('{"RoomId":2100,"RoomTeacher":"15420,15425"}');
            var userInfo = $.parseJSON('{"AdminId":15420}');
            var today = '2016-07-15';
            $(function () {
                require(["TeacherRoom/room"], function (room) {
                    var liveUe = room.CreateLiveEditor('live_editor');
                    var interUe = room.CreateInterEditor('inter_editor');
                    room.EditRoomTitle();
                    $("#btn_SendLive").on("click", function () {
                        room.SendLive(liveUe, 0, this, $("#btn_SendVipLive"));
                    });
                    $("#btn_SendVipLive").on("click", function () {
                        room.SendLive(liveUe, 1, this, $("#btn_SendLive"));
                    });
                    $("#btn_SendInter").on("click", function () {
                        room.SendInter(interUe, this);
                    });
                    $("#btn_SelAllInter,#ckb_SelAllInter").on("click", function () {
                        var $ckb = $("#ckb_SelAllInter");
                        if ($ckb.is(':checked')) {
                            $ckb.prop('checked', false);
                        }
                        else {
                            $ckb.prop('checked', true);
                        }
                        $("#InterList").find("input[type='checkbox']").prop('checked', $ckb.is(':checked'));
                    });
                    $("#InterList").find(".del_Inter").live("click", function () {
                        var $this = $(this);
                        var interId = $this.parent("span").data("interid");
                        room.DelInter(interId, $this);
                    });

                    $("#btn_BatchDel").on("click", function () {
                        room.BatchDelInter();
                    });

                    $("#InterList").find(".audit_Inter").live("click", function () {
                        var $this = $(this);
                        var interId = $this.parent("span").data("interid");
                        room.AuditInter(interId, $this);
                    });

                    $("#btn_BatchAudit").on("click", function () {
                        room.BatchAuditInter();
                    });

                    $("#btn_GetInterTop").on("click", function () {
                        var $this = $(this);
                        if (!$this.hasClass("top_no")) {
                            room.GetInterTop();
                        }
                    });

                    $("#InterList").find(".reply_Inter").live("click", function () {
                        room.ReplyInter($(this));
                    });

                    $(".live_his_list img").live("click", function (e) {
                        e = e || event;
                        var obj = e.target || e.srcElement;
                        if (obj.tagName.toLowerCase() == "img") {
                            if (obj.src.indexOf("/img/" + roomInfo.RoomId) > -1 && obj.src.lastIndexOf(".") > -1) {
                                var lastIndex = obj.src.lastIndexOf(".");
                                var url = obj.src.substr(0, lastIndex) + "_h" + obj.src.substr(lastIndex);
                                room.LoadRoomImg(url);
                            }
                        }
                    });

                    $('.live a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                        if (e.target && e.target.innerHTML.trim() == "直播历史") {
                            room.SetLiveListHeight();
                        }
                    });

                    $("#LiveTopList").find(".cancelTop_Live").live("click", function () {
                        var $this = $(this);
                        var liveId = $this.data("liveid");
                        room.CancelLiveTop(liveId, $this);
                    });

                    $("#LiveList").find(".top_Live").live("click", function () {
                        var $this = $(this);
                        var liveId = $this.parent("div").data("liveid");
                        room.SetLiveTop(liveId, $this);
                    });

                    $("#LiveList").find(".del_Live").live("click", function () {
                        var $this = $(this);
                        var liveId = $this.parent("div").data("liveid");
                        room.DelLive(liveId, $this);
                    });

                    $("#btn_GetLiveTop").on("click", function () {
                        var $this = $(this);
                        if (!$this.hasClass("top_no")) {
                            room.GetLiveTop();
                        }
                    });

                    $("#LiveList").find(".edit_Live").live("click", function () {
                        room.EditLive($(this));
                    });

                    $("#LiveList").find(".yinYong_Live").live("click", function () {
                        var $this = $(this);
                        var $parObj = $this.parents("li");
                        var name = $parObj.find(".avatar_box p").html().trim();
                        var cont = $parObj.find(".txt").html();
                        room.YinYongLive(name, cont, 1);
                    });

                    $("#InterList").find(".yinYong_Inter").live("click", function () {
                        var $this = $(this);
                        var name = $this.parents("li").find(".name b").first().html().trim();
                        var cont = $this.parents("li").find(".con_txt .con").html().trim();
                        room.YinYongLive(name, cont, 0);
                    });

                    $('#hisTime').datepicker({ weekStart: 1, format: 'yyyy-mm-dd', language: 'zh-CN', autoclose: true, todayHighlight: true, orientation: "top", endDate: "2016-07-15" }).on("changeDate", function (ev) {
                        var $this = $('#hisTime');
                        var oldDate = $this.data("olddate");
                        var time = ev.date.format("yyyy-MM-dd");
                        if (oldDate != time) {
                            $("#LiveTopList").empty();
                            $("#LiveList").empty();
                            $("#selLiveType,#selLiveTea").find("option:first").prop("selected", true);
                            if (time == today) {
                                room.GetTopLiveList();
                            }
                            room.GetLiveList(time);
                            $this.data("olddate", time);
                        }
                    });

                    $("#selLiveType,#selLiveTea").change(function () {
                        room.FilterLiveData();
                    });

                    $(window).resize(function () {
                        $("#header").width($(document).width());
                        $("#content").width($(document).width() - 220);
                    }).resize();
                });
            });
        </script>

</body>
</html>
